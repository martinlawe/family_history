<!DOCTYPE html>
<!--THIS IS A TEST FILE ONLY-->
<html lamg="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport,robots"
      content="width=device-width, initial-scale=1.0, noindex, nofollow"
    />
    <title>Brocas Family History</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <main>
      <div class="tree-container" id="tree-container">
        <svg id="tree-lines"></svg>

        <!-- Column 1 -->
        <div class="column" id="column1">
          <a
            href="../people/Sir_Bernard_Brocas.html"
            class="button-link"
            id="p1"
          >
            Sir Bernard Brocas (1330 - 1395)</a
          >
          <a
            href="../people/Bernard_Brocas_the_Younger.html"
            class="button-link"
            id="p2"
            >Sir Bernard Brocas Jr</a
          >
          <a
            href="../people/Under_Construction.html"
            class="button-link"
            id="p3"
          >
            William Brocas (1379 - 1456)</a
          >
          <a
            href="../people/Under_Construction.html"
            class="button-link"
            id="p4"
            >Elizabeth Brocas (1429 - 1475)</a
          >
          <a
            href="../people/Under_Construction.html"
            class="button-link"
            id="p5"
            >Isabella Moore (1448 - 1478)</a
          >
          <a
            href="../people/Under_Construction.html"
            class="button-link"
            id="p6"
            >William D'Oyly (1479 -)</a
          >
          <div class="sibling-row">
            <a href="../people/Sibling_One.html" class="button-link" id="p7"
              >Sibling One (1220)</a
            >
            <a href="../people/Sibling_Two.html" class="button-link" id="p8"
              >Sibling Two (1225)</a
            >
          </div>
        </div>
      </div>
    </main>
    <script>
      //This script fixed on Saturday 23rd August 2025 @ 09:57 is working perfectly.
      const connections = [
        { from: "p1", to: "p2", type: "vertical" },
        { from: "p2", to: "p3", type: "vertical" },
        { from: "p3", to: "p4", type: "vertical" },
        { from: "p4", to: "p5", type: "vertical" },
        { from: "p5", to: "p6", type: "vertical" },

        { from: "p6", to: ["p7", "p8"], type: "dogleg" },
      ];

      // Draw vertical line
      function drawVerticalLine(svg, fromEl, toEl) {
        const fromRect = fromEl.getBoundingClientRect();
        const toRect = toEl.getBoundingClientRect();
        const containerRect = svg.parentElement.getBoundingClientRect();

        const x1 = fromRect.left + fromRect.width / 2 - containerRect.left;
        const y1 = fromRect.bottom - containerRect.top;
        const x2 = toRect.left + toRect.width / 2 - containerRect.left;
        const y2 = toRect.top - containerRect.top;

        const path = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        path.setAttribute("d", `M${x1},${y1} L${x2},${y2}`);
        path.setAttribute("stroke", "black");
        path.setAttribute("stroke-width", "2");
        path.setAttribute("fill", "none");
        svg.appendChild(path);
      }

      // Draw dogleg line from side to side
      function drawDogleg(svg, fromEl, toEl) {
        const fromRect = fromEl.getBoundingClientRect();
        const toRect = toEl.getBoundingClientRect();
        const containerRect = svg.parentElement.getBoundingClientRect();

        const startX = fromRect.right - containerRect.left; // right side of bottom button
        const startY = fromRect.top + fromRect.height / 2 - containerRect.top;

        const endX = toRect.left - containerRect.left; // left side of top button
        const endY = toRect.top + toRect.height / 2 - containerRect.top;

        const offset = 40; // horizontal offset for dogleg

        const pathData = `M ${startX},${startY} H ${
          startX + offset
        } V ${endY} H ${endX}`;
        const path = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        path.setAttribute("d", pathData);
        path.setAttribute("stroke", "black");
        path.setAttribute("stroke-width", "2");
        path.setAttribute("fill", "none");
        svg.appendChild(path);
      }

      // Draw all connections
      function drawAllConnections() {
        const svg = document.getElementById("tree-lines");
        svg.innerHTML = "";

        connections.forEach((c) => {
          const fromEl = document.getElementById(c.from);
          const toEl = document.getElementById(c.to);
          if (!fromEl || !toEl) return;

          if (c.type === "vertical") {
            drawVerticalLine(svg, fromEl, toEl);
          } else if (c.type === "dogleg") {
            drawDogleg(svg, fromEl, toEl);
          }
        });
      }

      window.addEventListener("load", drawAllConnections);
      window.addEventListener("resize", drawAllConnections);
    </script>
  </body>
</html>
